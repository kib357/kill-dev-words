{"version":3,"sources":["Word.ts","Game.ts","desktop-mini.png","DesktopCanvas.tsx","Backup.js","GameScreen.tsx","Leaderboard.tsx","title.png","MainScreen.tsx","Registration.tsx","App.tsx","index.tsx"],"names":["Word","SCREENS","GAME_STATE","word","timestamp","pos","duration","isTyped","id","Math","floor","random","_word","setWord","newWord","setTyped","getWord","getTyped","isKilled","length","getTypedWord","words","find","sortByClosest","a","b","aTransitionLeft","bTransitionLeft","Game","WORDS","PLAYER_OFFSET","start_timestamp","Date","now","game_duration","state","PLAY","score","_score","addScore","scoreUp","particles","wordSpawnTimeout","getRandomDuration","spawnWord","timeout","generateSpawnTimeout","index","getRandomWord","getTimeIsUp","getKilledWordCount","getDuration","shootParticle","document","getElementById","clientWidth","clientHeight","progress","start","destinationPos","x","y","particle","key","String","destination","getParticles","onKeydown","e","char","code","toLowerCase","replace","newWords","typedWord","newTyped","sort","indexOf","findClosestWord","getState","current","tick","isTimeUp","killed","Boolean","countScore","isCollision","detectWordCollision","SCORE","filter","killWords","isFiltered","filtered","cleanParticles","DesktopCanvas","multiplier","useEffect","dpr","window","devicePixelRatio","background","width","height","context","getContext","scale","image","Image","src","DesktopMiniSrc","onload","drawImage","className","firebaseConfig","db","initializeApp","apiKey","authDomain","projectId","getFirestore","Backup","data","setDoc","doc","toFixed","stand","localStorage","getItem","formatScore","n","toString","Score","React","memo","value","decimals","speed","ease","customFunctionRender","Particle","offsetHeight","offsetWidth","containerHeight","containerWidth","map","bounce","keyframes","css","animation","position","bottom","left","transform","animationTimingFunction","low1","high1","low2","high2","padNumber","padStart","GameOver","GameScreen","props","playerId","playerName","useState","isScoreScreen","setScoreScreen","tickId","FPS","onLeaderboard","Words","useMemo","typed","substr","cursor","notTyped","steps","style","zIndex","transitionDuration","animationDuration","transitionTimingFunction","Particles","time","milliseconds","hour","minute","seconds","day","convertMS","max","deadlineValue","dealdlinePos","min","getDeadline","deadlinePos","timeoutId","timeoutLeaderboardId","setTimeout","leaderboardData","JSON","parse","name","contact","isCurrentPlayer","_id","push","setItem","stringify","deadline","clearTimeout","willChange","transition","marginLeft","minWidth","display","opacity","Leaderboard","onHome","showBtn","setBtn","keydownTimestamp","handleKeyDown","useCallback","preventDefault","stopPropagation","addEventListener","scrollIntoView","block","behavior","timeout2","WAIT","removeEventListener","undefined","maxWidth","textOverflow","overflowX","verticalAlign","onClick","MainScreen","onScreenChange","activeMenu","setActiveMenu","isToRegistration","setIsToReg","handleMouse","handleClick","removeItem","REGISTRATION","margin","TitleSrc","label","onMouseEnter","Registration","STEPS","isPractice","step","setStep","setName","setContact","GAME","htmlFor","type","autoComplete","onChange","target","paddingTop","prevResults","_name","_contact","data-progress","data-content","lib","1","split","2","3","4","5","6","authors","Object","values","flat","Lib","DURATION","App","leaderboard","setLeaderboard","setDuration","MAIN","screen","setScreen","handleScreenChange","_screen","gameLoopId","setGameLoopId","setTickId","setState","game","setGame","myCanvas","myConfetti","confetti","create","resize","end","lookPos","particleCount","spread","startVelocity","ticks","gravity","colors","shapes","origin","shootConfetti","console","log","handleLeaderboard","LEADERBOARD","interval","setInterval","clearInterval","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.719de56d.chunk.js","sourcesContent":["export interface IWord {\n  timestamp: number;\n  pos: number;\n  word?: string;\n  duration: number;\n  isTyped?: number;\n}\n\nexport interface IWordObject extends IWord {\n  getWord: () => string;\n  setWord: (word: string) => void;\n  getTyped: () => number;\n  setTyped: () => void;\n  id: number;\n  isKilled: () => boolean;\n}\n\nfunction Word(\n  { word = \"\", timestamp, pos, duration, isTyped = 0 }: IWord,\n  level = 0\n): IWordObject {\n  let id = Math.floor(Math.random() * 10000);\n  let _word = word;\n  // const timestamp = Date.now();\n  const getRandomX = () => {\n    return 0;\n    // max 100\n  };\n  const getRandomDuration = () => Math.random() * 100;\n  // const pos = getRandomX();\n  // const duration = getRandomDuration();\n  const setWord = (newWord: string) => (_word = newWord);\n  const setTyped = () => isTyped++;\n\n  return {\n    timestamp,\n    pos,\n    id,\n    getWord: () => _word,\n    getTyped: () => isTyped,\n    setTyped,\n    duration,\n    setWord,\n    isKilled: () => _word.length === isTyped,\n  };\n}\n\nexport default Word;\n","import Word, { IWord, IWordObject } from \"./Word\";\n\ninterface IGame {\n  duration?: number;\n  WORDS?: string[];\n  PLAYER_OFFSET: number;\n}\nexport type IDestination = { x: number; y: number };\n\nexport enum SCREENS {\n  \"MAIN\",\n  \"REGISTRATION\",\n  \"GAME\",\n  \"LEADERBOARD\",\n}\n\nexport interface IParticle {\n  duration: number;\n  destination: IDestination;\n  key: string;\n  timestamp: number;\n}\n\nexport interface IGameState {\n  state: GAME_STATE;\n  score: number;\n  game_duration: number;\n  words: IWordObject[];\n  getParticles: () => IParticle[];\n  current?: IWordObject;\n  start_timestamp: number;\n  getKilledWordCount: () => number;\n}\n\nexport enum GAME_STATE {\n  PLAY,\n  SCORE,\n}\n\nfunction Game({ duration = 30 * 1000, WORDS = [], PLAYER_OFFSET }: IGame) {\n  const start_timestamp = Date.now();\n  let game_duration = 0;\n  let state: GAME_STATE = GAME_STATE.PLAY;\n  const stopGame = (isTimeUp: boolean) => {\n    state = GAME_STATE.SCORE;\n    game_duration = isTimeUp ? duration : getDuration();\n  };\n\n  let score = 0;\n  let _score = 0;\n  const addScore = (word: IWordObject) => {\n    const scoreUp = word.getWord().length;\n    _score += scoreUp * 123; // TODO рефакторинг двух видов счета (внутренний=100 и внешний = 123 * длинна слова)\n    score += 100;\n  };\n\n  let particles: IParticle[] = [];\n\n  let words: IWordObject[] = [];\n  let wordSpawnTimeout = 0;\n  const getRandomDuration = (word: string) => {\n    const duration = Math.floor(\n      3500 + word.length * (2200 + Math.random() * 600)\n    );\n    // 0.6 -> 1\n    // 100 - 1\n    // 1000 - 10\n    // 5000 - 50\n    const levelMultiplier = score ? 1 - 0.6 * (score / 2400) : 1;\n\n    return duration * levelMultiplier;\n  };\n\n  // const getRandomDuration = (word: string) => {\n  //   const duration = Math.floor(\n  //     3800 + word.length * (1200 + Math.random() * 600)\n  //   );\n  //   const levelMultiplier = score >= 200 ? 1 / (score / 500) : 1;\n\n  //   return duration * levelMultiplier;\n  // };\n\n  const getRandomWord = () => {\n    const index = Math.floor(Math.random() * WORDS?.length);\n    return WORDS[index];\n  };\n  const getRandomPos = () => Math.floor(Math.random() * 100);\n  const spawnWord = () => {\n    const now = Date.now();\n    if (wordSpawnTimeout <= now) {\n      wordSpawnTimeout = generateSpawnTimeout();\n      const word = getRandomWord();\n      words = [\n        ...words,\n        Word({\n          word,\n          pos: getRandomPos(),\n          timestamp: Date.now(),\n          duration: getRandomDuration(word),\n        }),\n      ];\n    }\n  };\n\n  const getTimeIsUp = () => {\n    const now = Date.now();\n    return start_timestamp + duration <= now;\n  };\n\n  const getKilledWordCount = () => score / 100;\n\n  const getDuration = () => Date.now() - start_timestamp;\n\n  // PARTICLES\n  // TODO TESTS\n  const shootParticle = (word: IWordObject) => {\n    const PARTICLE_DURATION = 180;\n    const particlesContainer = document.getElementById(\n      \"particles\"\n    ) as HTMLElement | null;\n    const { clientWidth = 0, clientHeight = 0 } = particlesContainer || {};\n    const now = Date.now();\n    const { pos, duration, timestamp } = word;\n    const currentPos = duration - (now - timestamp + PARTICLE_DURATION);\n    const progress = 1 - (duration - currentPos) / duration;\n\n    // from x: 10%, y: 100%\n    const start = {\n      x: pos / 100,\n      y: 0,\n    };\n    // to x: 50%, y: 0% - PLAYER_OFFSET\n    const end = {\n      x: 0.5,\n      y: (clientHeight - PLAYER_OFFSET) / clientHeight,\n    };\n\n    // word current position\n    const destinationPos = {\n      x: start.x + (end.x - start.x) * (1 - progress),\n      y: start.y + (end.y - start.y) * (1 - progress),\n    };\n\n    const particle = {\n      timestamp: Date.now(),\n      key: String(Math.random() * 10000),\n      destination: destinationPos,\n      duration: PARTICLE_DURATION,\n    };\n    particles = [...particles, particle];\n  };\n  const getParticles = () => particles;\n\n  //  TODO TESTS\n  const cleanParticles = () => {\n    let isFiltered = false;\n    const now = Date.now(); // TODO refactor to global now value\n    const filtered = particles.filter(({ timestamp, duration }) => {\n      if (timestamp + duration < now) {\n        isFiltered = true;\n        return false;\n      }\n\n      return true;\n    });\n\n    if (isFiltered) {\n      particles = filtered;\n    }\n  };\n\n  return {\n    onKeydown: (e: { key: string; code: string }) => {\n      const prepareCode = (code: string) =>\n        code.toLowerCase().replace(\"key\", \"\");\n      const char = prepareCode(e.code);\n\n      const newWords = [...words]; // immutable\n      const typedWord = getTypedWord(newWords);\n      if (typedWord) {\n        const word = typedWord.getWord();\n        const isCorrect = word[typedWord?.getTyped()] === char;\n        if (isCorrect) {\n          typedWord.setTyped();\n          words = newWords;\n          shootParticle(typedWord);\n          return typedWord;\n        }\n      } else {\n        const newTyped = findClosestWord(words, char);\n        newTyped?.setTyped();\n        words = newWords;\n        newTyped && shootParticle(newTyped);\n        return newTyped;\n      }\n\n      return null;\n    },\n    getState: (): IGameState => {\n      return {\n        state,\n        score: _score,\n        getKilledWordCount,\n        game_duration,\n        words,\n        getParticles,\n        start_timestamp,\n        current: getTypedWord(words),\n      };\n    },\n    tick: () => {\n      const { score, killed } = countScore(words);\n      if (score && killed) addScore(killed);\n\n      const collision = detectWordCollision(words);\n      if (collision || getTimeIsUp()) {\n        stopGame(getTimeIsUp());\n      } else {\n        words = killWords(words);\n        spawnWord();\n      }\n\n      cleanParticles();\n    },\n  };\n}\n\nexport function getTypedWord(words: IWordObject[]) {\n  return words.find((word) => word.getTyped());\n}\n\nexport function generateSpawnTimeout() {\n  // TODO:GAMEPLAY use level\n  const now = Date.now();\n  const timeout = Math.floor(2000 + Math.random() * 2000);\n  return now + timeout;\n}\n\nexport function sortByClosest(a: IWord, b: IWord) {\n  const { timestamp: timestampA, duration: durationA } = a;\n  const { timestamp: timestampB, duration: durationB } = b;\n  const aTransitionLeft = timestampA + durationA;\n  const bTransitionLeft = timestampB + durationB;\n  if (aTransitionLeft < bTransitionLeft) {\n    return -1;\n  } else if (aTransitionLeft === bTransitionLeft) {\n    return 0;\n  }\n  return 1;\n}\n\nexport function findClosestWord(\n  words: IWordObject[],\n  char: string\n): IWordObject | null {\n  return (\n    words\n      .sort(sortByClosest)\n      .find(({ getWord }) => getWord().indexOf(char) === 0) || null\n  );\n}\n\nfunction isKilled(word: IWordObject) {\n  return word.isKilled();\n}\n\nexport function killWords(words: IWordObject[]): IWordObject[] {\n  return words.filter((word) => !isKilled(word));\n}\n\nexport function countScore(words: IWordObject[]): {\n  score: boolean;\n  killed: IWordObject | undefined;\n} {\n  const killed = words.find(isKilled);\n  return { score: Boolean(killed), killed };\n}\n\nexport function detectWordCollision(words: IWordObject[]): boolean {\n  const isCollision = ({ duration, timestamp }: IWordObject) => {\n    const now = Date.now();\n    return timestamp + duration <= now;\n  };\n  return Boolean(words.find(isCollision));\n}\n\nexport default Game;\n","export default __webpack_public_path__ + \"static/media/desktop-mini.e1b74462.png\";","import React, { useEffect } from \"react\";\nimport DesktopMiniSrc from \"./desktop-mini.png\";\n\ninterface IDesktopCanvas {\n  multiplier?: number;\n}\n\nfunction DesktopCanvas({ multiplier = 1.18 }: IDesktopCanvas) {\n  useEffect(() => {\n    const dpr = window.devicePixelRatio || 1;\n    const background = document.getElementById(\"desktop\") as HTMLCanvasElement;\n    // var rect = background.getBoundingClientRect();\n    background.width = background.clientWidth * dpr;\n    background.height = background.clientHeight * dpr;\n    const context = background.getContext(\"2d\");\n    if (!context) return;\n\n    context.scale(dpr, dpr);\n\n    const image = new Image();\n    image.src = DesktopMiniSrc;\n    image.onload = () => {\n      const width = image.width * multiplier;\n      const height = image.height * multiplier;\n      const x = background.width / dpr / 2 - width / 2;\n      const y = background.height / dpr / 2 - height / 2;\n      context.drawImage(image, x, y, width, height);\n\n      // const zoomInCanvas = () => {\n      //   console.log(\"zoom in\");\n      //   // context.clearRect(0, 0, canvas.width, canvas.height);\n      //   // const multiplier = 2;\n      //   // const width = image.width * multiplier;\n      //   // const height = image.height * multiplier;\n      //   // context.drawImage(image, 0, 0, width, height);\n      //   context.scale(20, 20);\n      // };\n\n      // setTimeout(() => {\n      //   zoomInCanvas();\n      // }, 2000);\n    };\n  }, []);\n\n  return <canvas id=\"desktop\" className=\"desktop\" />;\n}\n\nexport default DesktopCanvas;\n","import { initializeApp } from \"firebase/app\";\nimport { doc, setDoc, getFirestore } from \"firebase/firestore\";\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyCkSjB5frL3RsFb7PnyjbGmQDBbpa_phiQ\",\n  authDomain: \"kill-dev-words.firebaseapp.com\",\n  projectId: \"kill-dev-words\",\n  storageBucket: \"kill-dev-words.appspot.com\",\n  messagingSenderId: \"173670692157\",\n  appId: \"1:173670692157:web:e995ac1b7177c5a3328154\",\n};\n\nconst firebaseApp = initializeApp({\n  apiKey: firebaseConfig.apiKey,\n  authDomain: firebaseConfig.authDomain,\n  projectId: firebaseConfig.projectId,\n});\n\nconst db = getFirestore();\n\n// Initialize Firebase\n// const app = initializeApp(firebaseConfig);\n\nfunction Backup(data) {\n  //   app\n  setDoc(\n    doc(db, \"results\", Date.now() + \"-\" + String(Math.random().toFixed(6))),\n    { ...data, stand: localStorage.getItem(\"stand\") || \"none\" }\n  );\n}\n\nexport default Backup;\n","import React, { useEffect } from \"react\";\nimport { GAME_STATE, IGameState } from \"./Game\";\nimport NumberEasing from \"react-number-easing\";\nimport { keyframes } from \"@emotion/react\";\nimport { css } from \"@emotion/css\";\nimport DesktopCanvas from \"./DesktopCanvas\";\nimport Backup from \"./Backup\";\n\ntype IOnLeaderboard = { id?: string; deadline: string; score?: number };\n\nfunction GameScreen(props: {\n  state: IGameState | null;\n  tickId: number;\n  duration: number;\n  FPS: number;\n  onLeaderboard: (props: IOnLeaderboard) => void;\n}) {\n  const playerId =\n    localStorage.getItem(\"player-id\") ||\n    String(Math.floor(Math.random() * 100000));\n  const playerName = localStorage.getItem(\"player\");\n  const [isScoreScreen, setScoreScreen] = React.useState(false);\n  const { state, tickId, duration, FPS, onLeaderboard } = props;\n  const Words = React.useMemo(() => {\n    return state?.words.map((word) => {\n      const { duration } = word;\n      const _word = word.getWord();\n      const typed = _word.substr(0, word.getTyped());\n      const cursor = typed ? _word.substr(word.getTyped(), 1) : null;\n      const notTyped = _word.substr(\n        typed ? word.getTyped() + 1 : word.getTyped()\n      );\n\n      // duration min 500 max 10000\n      // 6000 - 60\n      const steps = Math.floor(duration / 90);\n\n      return (\n        <div\n          key={word.id}\n          className={`word toEnd eightBit`}\n          style={{\n            zIndex: cursor ? 2 : 1,\n            left: word.pos + \"%\",\n            transitionDuration: `${duration}ms`,\n            animationDuration: `${duration}ms`,\n            animationTimingFunction: `steps(${steps}, end)`,\n            transitionTimingFunction: `steps(${steps}, end)`,\n          }}\n        >\n          <span className=\"outlined_inverted\">{typed}</span>\n          {cursor ? <span className=\"cursor\">{cursor}</span> : null}\n          <span>{notTyped}</span>\n        </div>\n      );\n    });\n  }, [state?.words || []]);\n  const particles = state?.getParticles() || [];\n  const Particles = React.useMemo(\n    () => particles.map((particle) => <Particle {...particle} />),\n    [particles || []]\n  );\n\n  const { start_timestamp = 0 } = state || {};\n  const [deadlineValue, deadlinePos] = getDeadline({\n    start_timestamp,\n    duration,\n    tickId,\n  });\n\n  useEffect(() => {\n    let timeoutId: NodeJS.Timeout;\n    let timeoutLeaderboardId: NodeJS.Timeout;\n    if (state?.state === GAME_STATE.SCORE) {\n      timeoutId = setTimeout(() => {\n        setScoreScreen(true);\n\n        if (!playerName) {\n          timeoutLeaderboardId = setTimeout(() => {\n            onLeaderboard({\n              deadline: deadlineValue,\n              score: state.score,\n            });\n          }, 1500);\n          return;\n        }\n\n        let leaderboardData: {\n          id: string;\n          score: number;\n          name: string;\n          contact: string;\n        }[] = JSON.parse(localStorage.getItem(\"leaderboard\") || \"[]\");\n        const data = {\n          id: playerId,\n          name: playerName,\n          score: state.score,\n          contact: localStorage.getItem(\"contact\") || \"\",\n        };\n        Backup({ ...data, duration: state.game_duration });\n        // update previous results\n        // TODO save copy to FIREBASE\n        const isCurrentPlayer = (_id: string) => _id === playerId;\n        if (leaderboardData.find(({ id: _id }) => isCurrentPlayer(_id))) {\n          leaderboardData = leaderboardData.map((data) => {\n            if (isCurrentPlayer(data.id) && data.score < state.score) {\n              data.score = state.score;\n            }\n            return data;\n          });\n        } else {\n          leaderboardData.push(data);\n        }\n\n        localStorage.setItem(\"leaderboard\", JSON.stringify(leaderboardData));\n\n        timeoutLeaderboardId = setTimeout(() => {\n          onLeaderboard({\n            id: playerId,\n            deadline: deadlineValue,\n            score: state.score,\n          });\n        }, 1500);\n      }, 3000);\n    }\n\n    return () => {\n      clearTimeout(timeoutId);\n      clearTimeout(timeoutLeaderboardId);\n    };\n  }, [state?.state]);\n\n  return (\n    <div className={`game ${isScoreScreen ? \"leaderboard\" : null}`}>\n      <div className=\"deadline\">\n        <div\n          className=\"deadline-container\"\n          style={{\n            position: \"absolute\",\n            bottom: \"36px\",\n            left: \"36px\",\n            willChange: \"transform\",\n            transition: `transform ${Math.floor(1100 / FPS)}ms linear`,\n            transform: `translate3d(0,${Math.floor(\n              map(deadlinePos, 0, 1, -978, 0)\n            )}px,0)`,\n          }}\n        >\n          <div className=\"label\">\n            <span className=\"outlined\">DEADLINE</span>\n            <span className=\"countdown\" style={{ marginLeft: \"0.2em\" }}>\n              &nbsp;{deadlineValue}\n            </span>\n          </div>\n          <div className=\"score-in-deadline\">\n            <span className=\"outlined\">SCORE</span>\n            <span style={{ marginLeft: \"1.9em\" }}>\n              {formatScore(state?.score || 0)}\n            </span>\n          </div>\n        </div>\n      </div>\n      <div className=\"container\">\n        <div className=\"logo\"></div>\n        <div className=\"viewport\">\n          {state?.state === GAME_STATE.SCORE ? (\n            <GameOver duration={duration} state={state} />\n          ) : null}\n          {state?.state === GAME_STATE.PLAY ? (\n            <>\n              <div className=\"words\">{Words}</div>\n              <div className=\"particles\" id=\"particles\">\n                {Particles}\n              </div>\n            </>\n          ) : null}\n          <canvas\n            style={{ width: \"100%\", height: \"100%\" }}\n            id=\"fireworks\"\n          ></canvas>\n          <div className=\"player\"></div>\n        </div>\n        <DesktopCanvas />\n      </div>\n      <div className=\"sidebar\">\n        <div className=\"score\">\n          <span className=\"outlined\">SCORE</span>\n          <span\n            style={{\n              marginLeft: \"0.2em\",\n              minWidth: \"4em\",\n              display: \"inline-block\",\n            }}\n          >\n            &nbsp;\n            <Score key=\"score-wrapper\" value={state?.score} />\n          </span>\n        </div>\n        <div style={{ opacity: 0 }} className=\"typed-char outlined\">\n          T\n        </div>\n      </div>\n    </div>\n  );\n}\n\ninterface IScore {\n  value?: number;\n}\nexport function formatScore(n: number) {\n  return numberWithSpaces(Math.floor(n));\n}\nconst Score: React.FC<IScore> = React.memo(({ value = 0 }) => {\n  return (\n    <NumberEasing\n      decimals={0}\n      speed={1000}\n      key=\"score\"\n      ease=\"cubicIn\"\n      value={value}\n      customFunctionRender={formatScore}\n    />\n  );\n});\n\nfunction numberWithSpaces(x: number) {\n  return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n\ninterface IParticle {\n  destination: { x: number; y: number };\n  duration: number;\n  key: string;\n}\nfunction Particle({ destination, duration, key }: IParticle) {\n  const container = document.getElementById(\"particles\");\n  const { offsetHeight: containerHeight, offsetWidth: containerWidth } =\n    container || {\n      offsetHeight: 1,\n      offsetWidth: 1,\n    };\n  const x = map(destination.x, 0, 1, -containerWidth / 2, containerWidth / 2);\n  const y = map(destination.y, 0, 1, -containerHeight, 0);\n\n  const bounce = keyframes`\n  from, {\n    transform: translate3d(0, 0, 0);\n  }\n\n  to {\n    transform: translate3d(${x}px, ${y}px,0);\n  }\n`;\n\n  return (\n    <div\n      key={key}\n      className={css({\n        animation: `${bounce} ${duration}ms ease infinite`,\n        position: \"absolute\",\n        bottom: \"calc(45px - (9px / 2))\",\n        left: \"calc(50% - (9px / 2))\",\n        transform: \"translate(0, 0)\",\n        width: \"9px\",\n        height: \"9px\",\n        background: \"white\",\n        animationTimingFunction: `steps(${Math.floor(duration / 30)}, end)`,\n      })}\n    ></div>\n  );\n}\nfunction map(\n  value: number,\n  low1: number,\n  high1: number,\n  low2: number,\n  high2: number\n) {\n  return low2 + ((high2 - low2) * (value - low1)) / (high1 - low1);\n}\n\nfunction getDeadline({\n  start_timestamp,\n  duration,\n  tickId,\n}: {\n  start_timestamp: number;\n  duration: number;\n  tickId: number;\n}): [string, number] {\n  const progress = tickId - start_timestamp;\n  const time = convertMS(Math.max(duration - progress, 0));\n  const deadlineValue = `${padNumber(time.minute)}:${padNumber(time.seconds)}`,\n    // 0 -> 1\n    dealdlinePos = Math.min(progress, duration) / duration;\n\n  return [deadlineValue, dealdlinePos];\n}\n\nfunction padNumber(n: number) {\n  return String(n).padStart(2, \"0\");\n}\n\nfunction convertMS(milliseconds: number) {\n  var day, hour, minute, seconds;\n  seconds = Math.floor(milliseconds / 1000);\n  minute = Math.floor(seconds / 60);\n  seconds = seconds % 60;\n  hour = Math.floor(minute / 60);\n  minute = minute % 60;\n  day = Math.floor(hour / 24);\n  hour = hour % 24;\n  return {\n    day: day,\n    hour: hour,\n    minute: minute,\n    seconds: seconds,\n  };\n}\n\nfunction GameOver({\n  state,\n  duration,\n}: {\n  state: IGameState;\n  duration: number;\n}) {\n  return (\n    <div className=\"gameover eightBit\">\n      {state.game_duration === duration ? \"TIME IS UP\" : \"GAME OVER\"}\n    </div>\n  );\n}\n\nexport default GameScreen;\n","import React, { useEffect, useState } from \"react\";\nimport { formatScore } from \"./GameScreen\";\n\ninterface ILeaderboard {\n  id?: string;\n  deadline?: string;\n  score?: number;\n  onHome: () => void;\n}\n\ninterface IData {\n  id: string;\n  name: string;\n  score: number;\n}\n\nfunction Leaderboard({ id, deadline, onHome, score }: ILeaderboard) {\n  const [showBtn, setBtn] = useState(false);\n  const [data] = useState<IData[]>(\n    JSON.parse(localStorage.getItem(\"leaderboard\") || \"[]\").sort(\n      (a: any, b: any) => b.score - a.score\n    )\n  );\n  const _score = data.find(({ id: _id }) => _id === id)?.score || 0;\n\n  const keydownTimestamp = Date.now();\n  const handleKeyDown = React.useCallback((e: KeyboardEvent) => {\n    const _showBtn = Date.now() - keydownTimestamp > 6000;\n    // debugger;\n    if (_showBtn && e.code === \"Enter\") {\n      onHome();\n    }\n    e.preventDefault();\n    e.stopPropagation();\n  }, []);\n\n  useEffect(() => {\n    document.addEventListener(\"keydown\", handleKeyDown);\n\n    const WAIT = 4000;\n    let timeout = setTimeout(() => {\n      if (!id) return;\n\n      document\n        ?.getElementById(\"you\")\n        ?.scrollIntoView({ block: \"center\", behavior: \"smooth\" });\n    }, WAIT);\n\n    let timeout2 = setTimeout(() => {\n      setBtn(true);\n    }, WAIT + 2000);\n\n    return () => {\n      clearTimeout(timeout);\n      clearTimeout(timeout2);\n      document.removeEventListener(\"keydown\", handleKeyDown);\n    };\n  }, []);\n\n  return (\n    <div className=\"leaderboard\">\n      {deadline ? (\n        <div className=\"deadline\">\n          DEADLINE{\" \"}\n          <span className=\"outlined\" style={{ marginLeft: \"0.2em\" }}>\n            {deadline}\n          </span>\n        </div>\n      ) : null}\n      {score || _score ? (\n        <div className=\"score\">\n          <span className=\"outlined\">SCORE</span>\n          <span style={{ marginLeft: \"1.9em\" }}>\n            {formatScore(score || _score)}\n          </span>\n        </div>\n      ) : null}\n      <div className=\"board\">\n        {data.map(({ id: _id, name, score }, index) => (\n          <div>\n            <span\n              id={_id === id ? \"you\" : undefined}\n              className={_id === id ? \"\" : \"outlined\"}\n            >\n              {index + 1}.\n              <span\n                style={{\n                  marginLeft: \"0.5em\",\n                  maxWidth: \"1000px\",\n                  textOverflow: \"ellipsis\",\n                  overflowX: \"hidden\",\n                  display: \"inline-block\",\n                  verticalAlign: \"bottom\",\n                }}\n              >\n                {name}\n              </span>\n            </span>\n            <span style={{ marginLeft: \"0.5em\" }}>{formatScore(score)}</span>\n          </div>\n        ))}\n      </div>\n      <div\n        onClick={onHome}\n        style={{\n          opacity: showBtn ? 1 : 0,\n        }}\n        className=\"button eightBit\"\n      >\n        Return home\n      </div>\n    </div>\n  );\n}\n\nexport default Leaderboard;\n","export default __webpack_public_path__ + \"static/media/title.20631e3e.png\";","import React, { useState } from \"react\";\nimport TitleSrc from \"./title.png\";\nimport DesktopCanvas from \"./DesktopCanvas\";\nimport { SCREENS } from \"./Game\";\ninterface IMainScreen {\n  onScreenChange: (screen: SCREENS) => void;\n  onLeaderboard: (props: any) => void;\n}\n\nfunction MainScreen({ onScreenChange, onLeaderboard }: IMainScreen) {\n  const [activeMenu, setActiveMenu] = useState(0);\n  const [isToRegistration, setIsToReg] = useState(false);\n  const MENU = [\"START CHALLENGE\", \"PRACTICE\", \"LEADERBOARDS\"];\n  const handleMouse = (id: number) => () => {\n    setActiveMenu(id);\n  };\n  const handleClick = () => {\n    if (activeMenu === 0) {\n      setIsToReg(true);\n      setTimeout(() => {\n        localStorage.removeItem(\"skip-registration\");\n        onScreenChange(SCREENS.REGISTRATION);\n      }, 810);\n    } else if (activeMenu === 1) {\n      setIsToReg(true);\n      setTimeout(() => {\n        localStorage.setItem(\"skip-registration\", \"true\");\n        localStorage.removeItem(\"player\");\n        localStorage.removeItem(\"contact\");\n        onScreenChange(SCREENS.REGISTRATION);\n      }, 810);\n    } else if (activeMenu === 2) {\n      onLeaderboard({});\n    }\n  };\n\n  return (\n    <div\n      className={`main-screen ${isToRegistration ? \"to-registration\" : null}`}\n    >\n      <div className=\"container\">\n        <div className=\"logo\"></div>\n        <img\n          width=\"737\"\n          style={{\n            margin: \"70px auto\",\n            display: isToRegistration ? \"none\" : \"block\",\n          }}\n          src={TitleSrc}\n          className=\"title\"\n        />\n        <ul\n          className=\"menu eightBit\"\n          style={{\n            display: isToRegistration ? \"none\" : undefined,\n          }}\n        >\n          {MENU.map((label, id) => (\n            <li\n              onClick={handleClick}\n              onMouseEnter={handleMouse(id)}\n              className={activeMenu === id ? \"active\" : undefined}\n            >\n              {label}\n            </li>\n          ))}\n        </ul>\n        {/* <div className=\"registration\"></div> */}\n        {/* <div className=\"rules\"></div> */}\n        <DesktopCanvas multiplier={1} />\n      </div>\n    </div>\n  );\n}\n\nexport default MainScreen;\n","import React, { useEffect, useState } from \"react\";\nimport DesktopCanvas from \"./DesktopCanvas\";\nimport { SCREENS } from \"./Game\";\n\ninterface IRegistration {\n  onScreenChange: (screen: SCREENS) => void;\n}\n\nfunction Registration({ onScreenChange }: IRegistration) {\n  enum STEPS {\n    \"REGISTRATION\",\n    \"HOW-TO\",\n  }\n  const isPractice = localStorage.getItem(\"skip-registration\");\n  const [step, setStep] = useState(\n    isPractice ? STEPS[\"HOW-TO\"] : STEPS.REGISTRATION\n  );\n  const [name, setName] = useState(\"\");\n  const handleNameChange = (e: React.ChangeEvent<HTMLInputElement>) =>\n    setName(e.target.value);\n  const [contact, setContact] = useState(\"\");\n  const handleContactChange = (e: React.ChangeEvent<HTMLInputElement>) =>\n    setContact(e.target.value);\n  const handleToHowTo = () => {\n    if (!name || !contact) return;\n\n    let leaderboardData: {\n      id: string;\n      score: number;\n      name: string;\n      contact: string;\n    }[] = JSON.parse(localStorage.getItem(\"leaderboard\") || \"[]\");\n    const prevResults = leaderboardData.find(\n      ({ name: _name, contact: _contact }) =>\n        _name?.toLowerCase() === name?.toLowerCase() &&\n        _contact?.toLowerCase() === contact?.toLowerCase()\n    );\n    localStorage.setItem(\n      \"player-id\",\n      prevResults?.id || String(Math.floor(Math.random() * 100000))\n    );\n    localStorage.setItem(\"player\", name);\n    localStorage.setItem(\"contact\", contact);\n    setStep(STEPS[\"HOW-TO\"]);\n  };\n\n  useEffect(() => {\n    let timeout: NodeJS.Timeout;\n    if (step === STEPS[\"HOW-TO\"]) {\n      // timeout = setTimeout(() => {\n      //   onScreenChange(SCREENS.GAME);\n      // }, 15 * 1000);\n\n      timeout = setTimeout(() => {\n        onScreenChange(SCREENS.GAME);\n      }, 9 * 1000);\n    }\n\n    return () => {\n      clearTimeout(timeout);\n    };\n  }, [step]);\n\n  return (\n    <div className=\"registration\">\n      <DesktopCanvas />\n      <div className=\"logo\"></div>\n      {step === STEPS.REGISTRATION ? (\n        <div className=\"registration-step\">\n          <div className=\"text eightBit\">\n            Оставьте свои контакты, чтобы мы связались с вами в случае победы\n          </div>\n          <div>\n            <label className=\"eightBit\" htmlFor=\"player\">\n              ИМЯ\n              <input\n                type=\"text\"\n                name=\"player\"\n                autoComplete=\"off\"\n                className=\"eightBit\"\n                id=\"player\"\n                value={name}\n                onChange={handleNameChange}\n              />\n            </label>\n          </div>\n          <div style={{ paddingTop: \"30px\" }}>\n            <label className=\"eightBit\" htmlFor=\"contact\">\n              ТЕЛЕФОН ИЛИ ТЕЛЕГРАМ\n              <input\n                type=\"text\"\n                name=\"contact\"\n                autoComplete=\"off\"\n                id=\"contact\"\n                className=\"eightBit\"\n                value={contact}\n                onChange={handleContactChange}\n              />\n            </label>\n          </div>\n          <div>\n            <div\n              onClick={handleToHowTo}\n              style={{\n                opacity: name && contact ? 1 : 0.6,\n              }}\n              className=\"button eightBit\"\n            >\n              Register\n            </div>\n          </div>\n        </div>\n      ) : null}\n      {step === STEPS[\"HOW-TO\"] ? (\n        <div className=\"how-to\">\n          <div className=\"rules eightBit\">\n            <h1>ПРАВИЛА</h1>\n            <p>печатайте, чтобы выбивать слова</p>\n            {/* <p>\n              нажимайте как можно чаще по пробелу, чтобы закрыть всплывающее\n              окно\n            </p> */}\n            <p>\n              у вас есть {isPractice ? \"30 секунд\" : \"2 минуты\"}, чтобы\n              разобраться со всеми словами\n            </p>\n          </div>\n          <div\n            data-progress=\"20%\"\n            data-content=\"Loading...\"\n            className=\"eightBit loading inverted-bar\"\n          ></div>\n        </div>\n      ) : null}\n    </div>\n  );\n}\n\nexport default Registration;\n","import React, { useEffect, useState } from \"react\";\nimport \"./App.css\";\nimport Game, { GAME_STATE, IGameState, SCREENS } from \"./Game\";\nimport confetti, { shape } from \"canvas-confetti\";\nimport GameScreen from \"./GameScreen\";\nimport { IWordObject } from \"./Word\";\nimport Leaderboard from \"./Leaderboard\";\nimport MainScreen from \"./MainScreen\";\nimport Registration from \"./Registration\";\n\nconst PLAYER_OFFSET = 65;\nconst shootConfetti = (word: IWordObject) => {\n  const myCanvas = document.getElementById(\n    \"fireworks\"\n  ) as HTMLCanvasElement | null;\n  var myConfetti = myCanvas\n    ? confetti.create(myCanvas, { resize: true })\n    : confetti;\n  function randomInRange(min: number, max: number) {\n    return Math.random() * (max - min) + min;\n  }\n  const now = Date.now();\n  const { pos, duration, timestamp } = word;\n  const currentPos = duration - (now - timestamp);\n  const progress = 1 - (duration - currentPos) / duration;\n\n  if (myCanvas) {\n    // from x: 10%, y: 100%\n    const start = {\n      x: pos / 100,\n      y: 0,\n    };\n    // to x: 50%, y: 0% - PLAYER_OFFSET\n    const end = {\n      x: 0.5,\n      y: (myCanvas.clientHeight - PLAYER_OFFSET) / myCanvas.clientHeight,\n    };\n\n    // word current position\n    const lookPos = {\n      x: start.x + (end.x - start.x) * (1 - progress),\n      y: start.y + (end.y - start.y) * (1 - progress),\n    };\n\n    const look = {\n      particleCount: 5 + Math.random() * 10,\n      spread: 220,\n      startVelocity: 10,\n      ticks: 35,\n      gravity: 0.5,\n      colors: [\"#ffffff\"],\n      shapes: [\"square\"] as shape[],\n      origin: {\n        x: lookPos.x,\n        // since they fall down, start a bit higher than random\n        y: lookPos.y,\n      },\n    };\n\n    myConfetti(look);\n  } else {\n    const look = {\n      particleCount: 10,\n      spread: 220,\n      startVelocity: 10,\n      ticks: 40,\n      gravity: 0.4,\n      colors: [\"#ffffff\"],\n      shapes: [\"square\"] as shape[],\n      origin: {\n        x: Math.random(),\n        // since they fall down, start a bit higher than random\n        y: Math.random() - 0.2,\n      },\n    };\n\n    myConfetti(look);\n  }\n};\n\nconst FPS = 30;\n\nconst WORDS = Lib();\n\nconst DURATION_PRACTICE = 30 * 1000;\nconst DURATION = 2 * 60 * 1000; // minute\n// const DURATION = 1000;\n\nfunction App() {\n  const [leaderboard, setLeaderboard] = useState<null | {\n    id?: string;\n    deadline?: string;\n    score?: number;\n  }>(null);\n  const [duration, setDuration] = useState(DURATION);\n  const [screen, setScreen] = useState<SCREENS>(SCREENS.MAIN);\n  const handleScreenChange = (_screen: SCREENS) => setScreen(_screen);\n  const [gameLoopId, setGameLoopId] = useState<NodeJS.Timeout | null>(null);\n  const [tickId, setTickId] = useState(0);\n  const [state, setState] = useState<IGameState | null>(null);\n  let [game, setGame] = useState<any | null>(null);\n  const handleKeyDown = React.useCallback(\n    ({ key, code }: KeyboardEvent) => {\n      const state = game?.getState().state;\n\n      if (state === GAME_STATE.PLAY) {\n        const word = game?.onKeydown({ key, code });\n        if (word) {\n          word.isKilled() && shootConfetti(word);\n        } else {\n          console.log(\"miss\");\n        }\n      }\n    },\n    [game]\n  );\n\n  const handleLeaderboard = (props: {\n    id?: string;\n    score?: number;\n    deadline?: string;\n  }) => {\n    setLeaderboard(props);\n    document.removeEventListener(\"keydown\", handleKeyDown);\n    game = null;\n    setScreen(SCREENS.LEADERBOARD);\n  };\n\n  useEffect(() => {\n    if (screen === SCREENS.GAME) {\n      if (localStorage.getItem(\"skip-registration\")) {\n        setDuration(DURATION_PRACTICE);\n        setGame(Game({ WORDS, PLAYER_OFFSET, duration: DURATION_PRACTICE }));\n      } else {\n        setDuration(DURATION);\n        setGame(Game({ WORDS, PLAYER_OFFSET, duration: DURATION }));\n      }\n    }\n  }, [screen]);\n\n  useEffect(() => {\n    let interval: any;\n    if (game) {\n      document.addEventListener(\"keydown\", handleKeyDown);\n      const tick = () => {\n        game.tick();\n        setState(game.getState());\n        setTickId(Date.now());\n      };\n\n      tick();\n      interval = setInterval(tick, 1000 / FPS);\n      setGameLoopId(interval);\n    }\n\n    return () => {\n      clearInterval(interval);\n      document.removeEventListener(\"keydown\", handleKeyDown);\n    };\n  }, [game]);\n\n  useEffect(() => {\n    if (state?.state === GAME_STATE.SCORE) {\n      console.log(\"SCORE SCREEN\");\n      gameLoopId && clearInterval(gameLoopId);\n      setGameLoopId(null);\n    } else if (state?.state === GAME_STATE.PLAY) {\n      console.log(\"PLAY SCREEN\");\n    }\n  }, [state?.state]);\n\n  return (\n    <div className=\"App\">\n      {screen === SCREENS.MAIN ? (\n        <MainScreen\n          onLeaderboard={handleLeaderboard}\n          onScreenChange={handleScreenChange}\n        />\n      ) : null}\n      {screen === SCREENS.REGISTRATION ? (\n        <Registration onScreenChange={handleScreenChange} />\n      ) : null}\n      {screen === SCREENS.GAME ? (\n        <GameScreen\n          FPS={FPS}\n          duration={duration}\n          tickId={tickId}\n          state={state}\n          onLeaderboard={handleLeaderboard}\n        />\n      ) : null}\n      {screen === SCREENS.LEADERBOARD ? (\n        <Leaderboard\n          {...leaderboard}\n          onHome={() => {\n            handleScreenChange(SCREENS.MAIN);\n          }}\n        />\n      ) : null}\n    </div>\n  );\n}\n\nfunction Lib() {\n  // TODO добавить смешные слова, слова мемы программистов\n  var lib = {\n    1: \"nil npm lib go pen var if add zsh run php bug fix api key add all id em erb rem px ux ui svg for box git xml rtc pre rgb hsl rel web js def moz end to dev css\".split(\n      \" \"\n    ),\n    2: \"void yarn node null code scss bash else push edge ruby pull tidy head body foot haml slim jade true html color top span left right save fork flex none bold auto href link size ease fill path rgba hsla from skew sort font size team sass hash json less attr text data\".split(\n      \" \"\n    ),\n    3: \"react ember event width height clone gulp concat fetch valid aside style elsif babel jquery param start assign posts logos chrome blogs block align xcode slack class agile xmlns origin comma scrum stroke scale false rails\".split(\n      \" \"\n    ),\n    4: \"inline method deploy target assign window grunt commit minify jekyll stylus article import tweets google opacity weight bottom scroll italic profile hidden github keytrap editor webkit string number integer decimal period jsconf\".split(\n      \" \"\n    ),\n    5: \"inherit function includes bourbon normalize angular explorer section ternary twitter overflow absolute postcss invalid viewbox content sublime session display background compile bracket backbone boolean codepen dreamhire contains standup\".split(\n      \" \"\n    ),\n    6: \"chriscoyier javascript cssdevconf customers autoprefixer stackoverflow visibility headphones underscore bootstrap csstricks typescript livescript customer settings semicolon attribute parenthesis markdown compiler responsive preprocessor webdesign developer development\".split(\n      \" \"\n    ),\n    authors: \"gary petr anna sergey manychat\".split(\" \"),\n  };\n  return Object.values(lib).flat();\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals();\n"],"sourceRoot":""}